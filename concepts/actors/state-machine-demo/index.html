<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://microsoft.github.io/coyote/concepts/actors/state-machine-demo/">
    <link rel="shortcut icon" href="/coyote/img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>State machine demo - Coyote</title>
    <link href="/coyote/css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="/coyote/css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="/coyote/css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="/coyote/css/highlight.css">
    <link href="../../../css/main.css" rel="stylesheet">
    <link href="../../../css/player-controls.css" rel="stylesheet">
    <link href="../../../css/syntax.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="/coyote/js/jquery-3.2.1.min.js"></script>
    <script src="/coyote/js/bootstrap-3.3.7.min.js"></script>
    <script src="/coyote/js/highlight.pack.js"></script>
    <script src="https://consentdeliveryfd.azurefd.net/mscc/lib/v2/wcp-consent.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '/coyote/';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "State machine demo", url: "#_top", children: [
          ]},
        ];

    </script>
    <script src="/coyote/js/base.js"></script>
      <script src="../../../assets/js/analytics.js"></script>
      <script src="../../../assets/js/plugins.js"></script>
      <script src="../../../assets/js/animate_trace.js"></script>
      <script src="../../../assets/js/animation.js"></script>
      <script src="../../../assets/js/progress_bar.js"></script>
      <script src="../../../assets/js/trace_model.js"></script>
      <script src="../../../assets/js/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>

<div id="cookie-banner"></div>


<div class="wrapper wm-page-content">
  <div class="container-fluid">
    <a name="_top"></a>
      

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../why-actors/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../why-actors/" class="btn btn-xs btn-link">
        Why Coyote actors?
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../logging/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../logging/" class="btn btn-xs btn-link">
        Logging
      </a>
    </div>
    
  </div>

      

      <h2 id="state-machine-demo">State machine demo</h2>
<div class="animated_svg" trace="../../../assets/data/Raft.xml" svg="../../../assets/images/Raft.svg">
</div>

<!-- animating svg demo player controls -->
<!-- goes with _player-controls.scss -->
<div class="player-controls">
<div class="player-progress-bar"><svg class="progress-bar-svg" version="1.1"><rect id="progress-rect" y="14" height="8" class="player-button-fill"/></svg></div>
<button class="pause-button player-button" aria-label="Pause" title="Pause"><svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%"><path class="player-button-fill" d="M 12,26 16,26 16,10 12,10 z M 21,26 25,26 25,10 21,10 z" ></path></svg></button>
<button class="play-button player-button" aria-label="Play test mode" title="Play test mode"><svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%"><path class="player-button-fill" d="M 12,26 18.5,22 18.5,14 12,10 z M 18.5,22 25,18 25,18 18.5,14 z"></path></svg></button>
<button class="fastforward-button player-button" aria-label="Play production mode" title="Play production mode"><svg height="100%" version="1.1" viewBox="0 0 56 36" ><path class="player-button-fill" d="M 25,26 31.5,22 31.5,14 25,10 z M 31.5,22 38,18 38,18 31.5,14 z"></path><path class="player-button-fill" d="M 12,26 18.5,22 18.5,14 12,10 z M 18.5,22 25,18 25,18 18.5,14 z"></path></svg></button>
<button class="fullscreen-button hover-button-effect player-button" title="Full screen"><svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%"><g class="hover-button-effect-corner-0"><path class="player-button-fill" d="m 10,16 2,0 0,-4 4,0 0,-2 L 10,10 l 0,6 0,0 z"></path></g><g class="hover-button-effect-corner-1"><path class="player-button-fill" d="m 20,10 0,2 4,0 0,4 2,0 L 26,10 l -6,0 0,0 z"></path></g><g class="hover-button-effect-corner-2"><path class="player-button-fill" d="m 24,24 -4,0 0,2 L 26,26 l 0,-6 -2,0 0,4 0,0 z"></path></g><g class="hover-button-effect-corner-3"><path class="player-button-fill" d="M 12,20 10,20 10,26 l 6,0 0,-2 -4,0 0,-4 0,0 z" ></path></g></svg></button>
<button class="normal-screen-button  hover-button-effect player-button" title="Exit full screen"><svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%"><g class="hover-button-effect-corner-2"><path class="player-button-fill" d="m 14,14 -4,0 0,2 6,0 0,-6 -2,0 0,4 0,0 z" ></path></g><g class="hover-button-effect-corner-3"><path class="player-button-fill" d="m 22,14 0,-4 -2,0 0,6 6,0 0,-2 -4,0 0,0 z" ></path></g><g class="hover-button-effect-corner-0"><path class="player-button-fill" d="m 20,26 2,0 0,-4 4,0 0,-2 -6,0 0,6 0,0 z"></path></g><g class="hover-button-effect-corner-1"><path class="player-button-fill" d="m 10,22 4,0 0,4 2,0 0,-6 -6,0 0,2 0,0 z"></path></g></svg></button>
</div>
<p><br clear="all" /></p>
<p><svg id="svgfilter" width="0" height="0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <filter id="green-glow" filterUnits="userSpaceOnUse"
           x="-50%" y="-50%" width="200%" height="200%">
            <!-- blur the text at different levels-->
            <feGaussianBlur in="SourceGraphic" stdDeviation="5" result="blur5"/>
            <!-- merge all the blurs except for the first one -->
            <feMerge result="blur-merged">
                <feMergeNode in="blur10"/>
            </feMerge>
            <!-- recolor the merged blurs green-->
            <feColorMatrix result="green-blur" in="blur-merged" type="matrix"
                           values="0.06 0 0 0 0
                                   0 1 0 0 0
                                   0 0 0.44 0 0
                                   0 0 0 1 0" />
            <feMerge>
                <feMergeNode in="green-blur"/>
                <!-- largest blurs coloured green -->
                <feMergeNode in="blur5"/>
                <!-- smallest blur left white -->
                <feMergeNode in="SourceGraphic"/>
                <!-- original white text -->
            </feMerge>
        </filter>
    </defs>
</svg></p>
<p>This graph was generated from a <code>coyote test</code> with the <code>--xml-trace</code> and <code>--graph-bug</code> options on a
<code>StateMachine</code> based coyote application that implements the <code>Raft</code> protocol. The fact that coyote
<code>StateMachines</code> expose explicit state information makes it possible for <code>coyote</code> to visualize what
is going on in a level of detail that is hard to extract from other kinds of C# code. This
illustrates the benefit of this programming model both for software design, as well as
implementation enforcing this design, and testing that can find very hard to find bugs in these
kinds of complex distributed systems.</p>
<p>The trace shows a global order of messages being transferred between the various state machines. The
message exchange is shown to happen one after the other (when in production they may be happening in
parallel). This makes it easy to understand the trace. This trace, in fact, demonstrates a bug where
two Raft <code>Server</code> state-machines both end up claiming to be leaders at the same time which is a
violation of Raft&rsquo;s consensus requirements that there be at most one leader at a time.</p>
<p>This animation is slowed down from actual testing speed so you can see what is happening. This
entire test normally takes milliseconds so that Coyote can explore a huge number of possible
tests in a short amount of time.</p>

    <br>
      

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../why-actors/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../why-actors/" class="btn btn-xs btn-link">
        Why Coyote actors?
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../logging/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../logging/" class="btn btn-xs btn-link">
        Logging
      </a>
    </div>
    
  </div>

      <br>
  </div>
</div>

<footer class="wm-page-content">
  

<section class="footer-join pt-40 pb-80">
  <div class="container-fluid">
    <div class="row text-center">
      <div class="col-sm-8 col-sm-offset-2">
      </div>
    </div>
    <div class="row">
   </div>
  </div>
</section>
<section class="footer-dark pt-60">
  <div class="container-fluid">
    <div class="row">
      <div class="hidden-xs col-sm-5 col-lg-6">
        <a href="" title="homepage" class="logo-footer">
          <img src="/coyote/assets/images/icon.png" alt="Coyote">
        </a>
      </div>

      <div class="col-sm-2 col-xs-4 footer-dark-col">
        <nav>
          <h4>Coyote</h4>
          <ul class="list-unstyled">
            <li><a href="/coyote/">Home</a></li>
            <li><a href="/coyote/get-started/install/">Install</a></li>
          </ul>
        </nav>
      </div>

      <div class="col-sm-2 col-xs-4 footer-dark-col">
        <nav>
          <h4>Resources</h4>
          <ul class="list-unstyled">
            <li><a href="/coyote/tutorials/first-concurrency-unit-test/">Getting started</a></li>
            <li><a href="/coyote/tutorials/overview/">Tutorials</a></li>
            <li><a href="/coyote/ref/Microsoft.Coyote">API documentation</a></li>
          </ul>
        </nav>
      </div>

      <div class="col-sm-2 col-xs-4 footer-dark-col">
        <nav>
          <h4>Community</h4>
          <ul class="list-unstyled">
            <li><a href="https://github.com/microsoft/coyote/"><i class="fa fa-github"></i>
GitHub</a></li>
            <li><a href="https://twitter.com/coyote_dev" target="_blank"><i class="fa fa-twitter"></i> Twitter</a></li>
            <li><a href="https://gitter.im/microsoft/coyote" target="_blank">Gitter</a></li>
          </ul>
        </nav>
      </div>
    </div>

    <div class="row footnote pt-50 pb-20">
      <div class="col-sm-12">
        <hr>
      </div>
      <div class="col-sm-6">
        <ul class="list-unstyled list-inline footnote-copy">
          <li><a href="https://privacy.microsoft.com/en-us/privacystatement/" target="_blank">Privacy</a></li>
          <li><a href="https://www.microsoft.com/en-us/legal/intellectualproperty/copyright/default.aspx" target="_blank">Terms of Use</a></li>
          <li><a href="https://github.com/microsoft/coyote/blob/main/LICENSE" target="_blank">License</a></li>
          <li><a href="javascript:manageCookies()">Cookies</a></li>
        </ul>
      </div>
      <div class="col-sm-6 text-right footnote-copy">
        <ul class="list-unstyled list-inline">
          <li><span id="copyright"></span></li>
          <li><a href="https://www.microsoft.com/" target="_blank"><img class="img-responsive" src="/coyote/assets/images/microsoft-logo.svg?v=3" alt="Microsoft">&nbsp;</a></li>
        </ul>
      </div>
    </div>
  </div>
</section>
</footer>


<script type="text/javascript">
    $(document).ready(function () {
      $('table').each(function () {
        $(this).addClass("table");
        $(this).addClass("table-bordered");
        $(this).addClass("table-striped");
        $(this).addClass("table-condensed");
      });

    });
</script>

</body>
</html>